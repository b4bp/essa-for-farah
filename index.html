<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ğŸ’– Ù„Ù„Ù…Ù„ÙƒØ© ÙØ±Ø­ - Ù…Ù† Ø¹ÙŠØ³Ù‰ ğŸ’–</title>
<!-- Link Preview / Open Graph -->
<meta property="og:type" content="website">
<meta property="og:site_name" content="essa-for-farah">
<meta property="og:title" content="ğŸ’– Ù„Ù„Ù…Ù„ÙƒØ© ÙØ±Ø­ - Ù…Ù† Ø¹ÙŠØ³Ù‰ ğŸ’–">
<meta property="og:description" content="Ù‡Ø¯ÙŠØ© Ø­Ø¨ Ø®Ø§ØµØ© ÙÙŠÙ‡Ø§ ÙÙŠØ¯ÙŠÙˆ ÙˆØµÙˆØ± ÙˆØµÙˆØªâ€¦ Ø§ÙØªØ­ÙŠÙ‡Ø§ ğŸ’—">
<meta property="og:url" content="https://b4bp.github.io/essa-for-farah/">
<meta property="og:image" content="https://b4bp.github.io/essa-for-farah/preview.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<!-- Twitter / Discord -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="ğŸ’– Ù„Ù„Ù…Ù„ÙƒØ© ÙØ±Ø­ - Ù…Ù† Ø¹ÙŠØ³Ù‰ ğŸ’–">
<meta name="twitter:description" content="Ø§Ù‡Ø¯Ø§Ø¡ Ø®Ø§Øµ Ø§ÙØªØ­ÙŠÙ‡ ğŸ’—">
<meta name="twitter:image" content="https://b4bp.github.io/essa-for-farah/preview.jpg">

  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#FFF3FA;
      --bg2:#F2F7FF;

      --card: rgba(255,255,255,.78);
      --stroke: rgba(20,10,40,.10);
      --shadow: 0 18px 60px rgba(30, 20, 60, .12);

      --text:#2A2440;
      --muted:#6B5F86;

      --pink:#FF5BA6;
      --lav:#8B7CFF;
      --mint:#2ED9A3;
      --yellow:#FFD35A;

      --insta-gradient: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
      --grad: linear-gradient(135deg, rgba(255,91,166,.28), rgba(139,124,255,.24));

      --r:24px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: 'Tajawal', system-ui, -apple-system, "Segoe UI", Tahoma, Arial;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(255,91,166,.22), transparent 55%),
        radial-gradient(1000px 650px at 90% 30%, rgba(139,124,255,.20), transparent 55%),
        radial-gradient(900px 600px at 50% 95%, rgba(46,217,163,.18), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
      padding: 18px 14px 36px;
    }

    /* stickers */
    .stickers{position:fixed; inset:0; pointer-events:none; z-index:0; opacity:.7}
    .st{position:absolute; font-size:clamp(18px,2.6vw,34px); filter: drop-shadow(0 10px 18px rgba(0,0,0,.10)); animation: floaty 9s ease-in-out infinite;}
    .st:nth-child(2){animation-duration: 11s}
    .st:nth-child(3){animation-duration: 13s}
    .st:nth-child(4){animation-duration: 10s}
    .st:nth-child(5){animation-duration: 12s}
    @keyframes floaty{0%,100%{transform: translateY(0) rotate(-2deg)}50%{transform: translateY(-14px) rotate(2deg)}}

    .container{
      position:relative; z-index:1;
      width:min(980px,100%);
      margin:0 auto;
      display:grid;
      gap:14px;
    }

    .glass{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      overflow:hidden;
    }

    .top{
      padding:16px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }

    .signature{
      display:inline-flex; align-items:center; gap:10px;
      background: rgba(255,91,166,.14);
      border:1px solid rgba(255,91,166,.22);
      padding:10px 14px;
      border-radius:999px;
      color: var(--pink);
      font-weight:700;
      box-shadow:0 10px 25px rgba(255,91,166,.10);
    }

    .header{
      padding: 8px 16px 18px;
      text-align:center;
    }
    .header h1{
      margin:0;
      font-size: clamp(22px, 3.4vw, 40px);
      background: linear-gradient(135deg, rgba(255,91,166,1), rgba(139,124,255,1));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      letter-spacing:.2px;
    }
    .subtitle{
      margin:8px 0 0;
      color: var(--muted);
      font-size: 14px;
      line-height:1.8;
    }

    .heart-badge{
      margin:14px auto 0;
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid rgba(255,91,166,.22);
      background: rgba(255,91,166,.12);
      box-shadow:0 10px 22px rgba(255,91,166,.10);
    }
    .heart{
      width:22px;height:22px; position:relative; animation: heartbeat 1.2s infinite;
    }
    .heart::before,.heart::after{
      content:"";
      position:absolute;
      width:12px;height:18px;
      background: var(--pink);
      border-radius: 12px 12px 0 0;
    }
    .heart::before{left:11px; transform: rotate(-45deg); transform-origin: 0 100%;}
    .heart::after{left:0; transform: rotate(45deg); transform-origin: 100% 100%;}
    @keyframes heartbeat{0%,100%{transform:scale(1)}50%{transform:scale(1.12)}}

    .timer-card{
      margin: 0 16px 16px;
      border-radius: 20px;
      border:1px solid rgba(139,124,255,.18);
      background: rgba(139,124,255,.10);
      padding:14px;
      text-align:center;
    }
    .timer-card h3{
      margin:0 0 8px;
      color:#5b4cff;
      font-size: 15px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      font-weight:800;
    }
    #relationshipTimer{
      font-size: clamp(18px, 3.2vw, 28px);
      font-weight: 900;
      background: linear-gradient(135deg, rgba(255,91,166,1), rgba(139,124,255,1));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      direction:ltr;
      letter-spacing:.5px;
      font-variant-numeric: tabular-nums;
    }
    .timer-label{margin-top:6px; color:var(--muted); font-size:12.5px}

    /* section */
    .section{padding:16px}
    .sectionTitle{
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
      margin-bottom: 10px;
    }
    .sectionTitle b{font-size:15px}
    .meta{font-size:12.5px; color:var(--muted); font-variant-numeric: tabular-nums;}

    /* buttons */
    .btn{
      cursor:pointer;
      border:1px solid rgba(0,0,0,.08);
      background:#fff;
      color: var(--text);
      padding:12px 14px;
      border-radius: 16px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      text-decoration:none;
      transition: transform .16s ease, box-shadow .16s ease, background .16s ease;
      user-select:none;
      box-shadow: 0 10px 25px rgba(0,0,0,.06);
      font-size:14px;
      font-family:'Tajawal', sans-serif;
      min-height: 44px; /* mobile friendly */
    }
    .btn:hover{transform: translateY(-1px)}
    .btn.primary{
      background: var(--grad);
      border-color: rgba(255,91,166,.22);
    }
    .btn.insta{
      background: var(--insta-gradient);
      color:white;
      border:none;
      box-shadow: 0 10px 25px rgba(228, 64, 95, 0.25);
    }
    .btn.insta:hover{box-shadow: 0 15px 30px rgba(228, 64, 95, 0.35);}
    .btn.soft{background: rgba(255,255,255,.70);}

    .btnRow{
      display:flex; gap:10px; flex-wrap:wrap;
      justify-content:flex-start;
      align-items:center;
      margin-top: 10px;
    }

    /* VIDEO (first section) */
    .videoWrap{
      border-radius: 20px;
      overflow:hidden;
      border:1px solid rgba(0,0,0,.08);
      background:#000;
      box-shadow: 0 14px 35px rgba(0,0,0,.10);
    }
    .custom-video{
      width:100%;
      height:auto;
      display:block;
      background:#111;
      max-height: 70vh;
    }

    .controlsStack{
      display:grid;
      gap:10px;
      margin-top:12px;
    }
    .rangeRow{
      display:grid;
      gap:8px;
      border:1px solid rgba(0,0,0,.08);
      background: rgba(255,255,255,.68);
      border-radius: 18px;
      padding: 12px;
      box-shadow: 0 10px 22px rgba(0,0,0,.05);
    }
    .rangeHead{
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
      color: var(--muted);
      font-size: 12.5px;
    }
    input[type="range"]{
      width:100%;
      accent-color: var(--pink);
      height: 28px;
    }

    /* Message typing box (second section) */
    .message-box{
      border-radius: 20px;
      border:1px solid rgba(0,0,0,.08);
      background: rgba(255,255,255,.70);
      padding: 16px;
      min-height: 170px;
      line-height:1.9;
      font-size: 15px;
      color: var(--text);
      overflow-wrap: break-word;
      box-shadow: 0 12px 30px rgba(0,0,0,.06);
      margin-top:12px;
    }
    .message-line{margin-bottom:10px; opacity:0; animation: fadeIn .45s ease forwards;}
    @keyframes fadeIn{to{opacity:1}}
    .typing-cursor{display:inline-block;width:2px;height:1.2em;background:var(--pink);animation:blink 1s infinite;margin-right:2px;vertical-align:middle;}
    @keyframes blink{0%,100%{opacity:1}50%{opacity:0}}

    /* Reply */
    .reply-section{
      margin-top:16px;
      padding-top:14px;
      border-top: 1px dashed rgba(0,0,0,.12);
    }
    .reply-section h3{
      margin:0 0 10px;
      font-size: 15px;
      font-weight: 900;
      color:#5b4cff;
      display:flex; align-items:center; gap:8px;
    }
    .reply-input-container{position:relative}
    .reply-input{
      width:100%;
      min-height:140px;
      resize: vertical;
      border-radius: 18px;
      border:1px solid rgba(0,0,0,.10);
      background: rgba(255,255,255,.70);
      padding: 14px 14px 30px;
      font-family:'Tajawal', sans-serif;
      font-size: 15px;
      color: var(--text);
      outline:none;
    }
    .reply-input:focus{
      border-color: rgba(255,91,166,.45);
      box-shadow: 0 0 0 3px rgba(255,91,166,.18);
    }
    .char-counter{
      position:absolute;
      bottom:10px;
      left:14px;
      font-size: 12px;
      color: var(--muted);
      font-variant-numeric: tabular-nums;
    }
    .reply-buttons{
      display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;
      margin-top:10px;
    }
    .dm-info{
      margin-top:10px;
      border-radius: 16px;
      border:1px solid rgba(228,64,95,.18);
      background: rgba(228,64,95,.08);
      padding: 10px 12px;
      color: var(--muted);
      font-size: 12.5px;
      line-height:1.7;
    }
    .dm-info strong{color:#cc2366}

    /* Gallery + Song (last section) */
    .twoCols{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
      align-items:start;
    }
    @media (max-width: 860px){
      .twoCols{grid-template-columns:1fr;}
    }

    .local-gallery{
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 12px;
      margin-top: 10px;
    }
    .local-gallery-item{
      position:relative;
      border-radius: 18px;
      overflow:hidden;
      aspect-ratio: 4/3;
      border:1px solid rgba(0,0,0,.08);
      background: rgba(255,255,255,.68);
      cursor:pointer;
      transition: transform .18s ease, box-shadow .18s ease;
      box-shadow: 0 10px 22px rgba(0,0,0,.06);
    }
    .local-gallery-item:hover{transform: translateY(-2px); box-shadow:0 16px 30px rgba(255,91,166,.14)}
    .local-gallery-item img{width:100%; height:100%; object-fit:cover; display:block}
    .local-gallery-overlay{
      position:absolute; left:0; right:0; bottom:0;
      padding: 10px 10px;
      color:#fff;
      font-size: 12px;
      background: linear-gradient(transparent, rgba(0,0,0,.55));
      opacity:0;
      transition: opacity .18s ease;
    }
    .local-gallery-item:hover .local-gallery-overlay{opacity:1}
    .gallery-placeholder{
      border:1px dashed rgba(0,0,0,.18);
      background: rgba(255,255,255,.55);
      border-radius: 18px;
      padding: 18px;
      text-align:center;
      color: var(--muted);
    }

    /* Lightbox */
    .lightbox{
      position:fixed; inset:0;
      background: rgba(0,0,0,.75);
      display:none;
      align-items:center;
      justify-content:center;
      padding:16px;
      z-index:9999;
    }
    .lightbox.active{display:flex}
    .lightbox-content{position:relative; max-width: 94%; max-height: 92%;}
    .lightbox-content img{
      max-width: 100%;
      max-height: 78vh;
      border-radius: 16px;
      box-shadow: 0 16px 50px rgba(0,0,0,.45);
      border:1px solid rgba(255,255,255,.20);
    }
    .lightbox-close{
      position:absolute; top:-46px; right:0;
      background: rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.25);
      color:#fff;
      width:44px;height:44px;border-radius:14px;
      cursor:pointer;
      font-size:24px;
      display:grid; place-items:center;
    }
    .lightbox-nav{
      position:absolute; top:50%; transform:translateY(-50%);
      background: rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.25);
      color:#fff;
      width:52px;height:52px;border-radius:999px;
      cursor:pointer;
      display:grid; place-items:center;
      font-size:20px;
    }
    .lightbox-nav.prev{right:-8px}
    .lightbox-nav.next{left:-8px}

    /* Alerts */
    .alert{
      position:fixed;
      top:16px;
      right:16px;
      max-width: 380px;
      padding: 12px 14px;
      border-radius: 18px;
      color:#fff;
      display:flex;
      gap:10px;
      align-items:flex-start;
      transform: translateX(140%);
      transition: transform .45s ease;
      z-index:10000;
      box-shadow: 0 18px 45px rgba(0,0,0,.22);
    }
    .alert.show{transform: translateX(0)}
    .alert .icon{width:28px;height:28px;border-radius:10px; display:grid; place-items:center; background:rgba(255,255,255,.18)}
    .alert.success{background: rgba(46,217,163,.92)}
    .alert.info{background: rgba(139,124,255,.92)}
    .alert.warning{background: rgba(255,152,0,.92)}
    .alert.danger{background: rgba(255,91,166,.92)}
    .alert span{line-height:1.6; font-size: 13px}

    /* End video modal */
    .modal{
      position:fixed; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      padding:16px;
      background: rgba(0,0,0,.45);
      z-index: 12000;
    }
    .modal.show{display:flex}
    .modalBox{
      width:min(560px, 100%);
      border-radius: 24px;
      border:1px solid rgba(255,255,255,.35);
      background: rgba(255,255,255,.95);
      box-shadow: 0 22px 70px rgba(0,0,0,.25);
      backdrop-filter: blur(12px);
      overflow:hidden;
      animation:modalSlide .28s ease;
    }
    @keyframes modalSlide{from{transform:translateY(18px); opacity:0;}to{transform:translateY(0); opacity:1;}}
    .modalTop{
      padding:14px 16px;
      background: linear-gradient(135deg, rgba(255,91,166,.22), rgba(139,124,255,.18));
      border-bottom:1px solid rgba(0,0,0,.06);
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .modalTop b{font-size:15px}
    .modalBody{
      padding:18px 18px 8px;
      max-height: 55vh;
      overflow:auto;
      line-height:1.9;
      color:var(--text);
      font-size:15px;
    }
    .modalActions{
      padding:14px 16px 16px;
      display:flex; gap:10px; flex-wrap:wrap;
      border-top:1px dashed rgba(0,0,0,.08);
      justify-content:flex-end;
    }

    /* Footer */
    .footer{
      padding: 12px 16px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      color: var(--muted);
      font-size: 12.5px;
    }
    @media (max-width: 560px){
      .footer{justify-content:center; text-align:center}
      .btnRow .btn{width:100%}
      .reply-buttons{justify-content:stretch}
      .reply-buttons .btn{width:100%}
    }

    /* =========================
       NEW: Poem like screenshot
       ========================= */
    .poemGrid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:14px;
      align-items:start;
    }
    @media (max-width: 860px){
      .poemGrid{grid-template-columns:1fr;}
    }

    .poemCard{
      border-radius: 22px;
      border:1px solid rgba(255,91,166,.18);
      background: rgba(255,255,255,.68);
      box-shadow: 0 12px 30px rgba(0,0,0,.06);
      overflow:hidden;
    }
    .poemTop{
      padding:12px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background: linear-gradient(135deg, rgba(255,91,166,.10), rgba(139,124,255,.08));
      border-bottom:1px solid rgba(0,0,0,.06);
    }
    .poemTop .title{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:900;
      color:#3b3457;
    }
    .miniPill{
      font-size:12px;
      color: var(--muted);
      background: rgba(255,255,255,.70);
      border:1px solid rgba(0,0,0,.06);
      padding:8px 10px;
      border-radius: 999px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      user-select:none;
    }
    .iconBtn{
      cursor:pointer;
      border:1px solid rgba(0,0,0,.08);
      background: rgba(255,255,255,.75);
      width:42px;
      height:42px;
      border-radius: 14px;
      display:grid;
      place-items:center;
      box-shadow: 0 10px 22px rgba(0,0,0,.06);
      transition: transform .16s ease;
      font-size:18px;
    }
    .iconBtn:hover{transform: translateY(-1px)}
    .poemBody{
      padding:14px;
    }
    .poemBox{
      border-radius: 18px;
      border:1px solid rgba(255,91,166,.20);
      background:
        radial-gradient(600px 280px at 10% 10%, rgba(255,91,166,.10), transparent 55%),
        radial-gradient(600px 280px at 90% 20%, rgba(139,124,255,.10), transparent 55%),
        rgba(255,255,255,.62);
      padding:16px 14px;
      min-height: 320px;
      position:relative;
      overflow:hidden;
    }
    .poemBox:before{
      content:"";
      position:absolute;
      inset:10px;
      border-radius: 16px;
      border:1px dashed rgba(139,124,255,.28);
      pointer-events:none;
    }
    .poemHeaderLine{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      margin-bottom: 10px;
      font-weight:900;
      color:#3b3457;
    }
    .poemHeaderLine .rose{
      filter: drop-shadow(0 10px 16px rgba(255,91,166,.18));
    }
    .poemText{
      text-align:center;
      line-height: 2.05;
      color:#2A2440;
      white-space: pre-wrap;
      font-size: 15px;
      padding: 4px 6px 2px;
      outline:none;
    }
    .poemText[contenteditable="true"]{
      background: rgba(255,255,255,.55);
      border:1px solid rgba(0,0,0,.08);
      border-radius: 14px;
      padding:10px 10px;
    }
    .poemFooter{
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px dashed rgba(0,0,0,.10);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      color: var(--muted);
      font-size: 12.5px;
    }

    .audioCard{
      border-radius: 22px;
      border:1px solid rgba(0,0,0,.08);
      background: rgba(255,255,255,.68);
      box-shadow: 0 12px 30px rgba(0,0,0,.06);
      overflow:hidden;
    }
    .audioTop{
      padding:12px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      background: linear-gradient(135deg, rgba(139,124,255,.10), rgba(255,91,166,.08));
      border-bottom:1px solid rgba(0,0,0,.06);
    }
    .audioTop b{
      display:flex;
      align-items:center;
      gap:10px;
      font-size: 15px;
    }
    .audioBody{
      padding:14px;
    }
    .audioHint{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.7;
      margin-bottom: 10px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .audioBtnRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-start;
      margin-bottom: 12px;
    }
    .tinyBtn{
      cursor:pointer;
      border:1px solid rgba(0,0,0,.08);
      background: rgba(255,255,255,.80);
      padding:10px 12px;
      border-radius: 16px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      box-shadow: 0 10px 22px rgba(0,0,0,.06);
      font-family:'Tajawal', sans-serif;
      font-size: 13.5px;
      min-height: 42px;
      transition: transform .16s ease;
      user-select:none;
    }
    .tinyBtn:hover{transform: translateY(-1px)}
    .tinyBtn.primary{
      background: var(--grad);
      border-color: rgba(255,91,166,.22);
    }
    .seekWrap{
      display:grid;
      gap:10px;
    }
    .labelRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      color: var(--muted);
      font-size: 12.5px;
    }
  </style>
</head>

<body>
  <div class="stickers" aria-hidden="true">
    <div class="st" style="top:9%; left:7%;">ğŸ§¸</div>
    <div class="st" style="top:18%; right:10%;">ğŸ’—</div>
    <div class="st" style="top:64%; left:10%;">ğŸ“</div>
    <div class="st" style="top:72%; right:12%;">âœ¨</div>
    <div class="st" style="top:40%; left:46%;">ğŸ€</div>
  </div>

  <div class="container">

    <!-- Header card -->
    <div class="glass">
      <div class="top">
        <div class="signature" id="signatureText">ğŸ§¸ Ù…Ù† Ø¹ÙŠØ³Ù‰ Ø¥Ù„Ù‰ ÙØ±Ø­</div>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <a class="btn insta" id="igLink" href="https://instagram.com/wz7an" target="_blank" rel="noreferrer">ğŸ“· instagram.com/wz7an</a>
          <button class="btn soft" id="refreshGalleryBtn">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±</button>
        </div>
      </div>

      <div class="header">
        <h1 id="mainTitle">ğŸ’– Ù„Ù„Ù…Ù„ÙƒØ© ÙØ±Ø­ ğŸ’–</h1>
        <p class="subtitle" id="mainSubtitle">Ù‡Ø¯ÙŠØ© Ø­Ø¨ Ø±Ù‚Ù…ÙŠØ© Ù…Ø¹ ÙÙŠØ¯ÙŠÙˆ ÙˆØµÙˆØ± Ù…Ù† Ø§Ù„Ù‚Ù„Ø¨</p>
        <div class="heart-badge">
          <div class="heart"></div>
          <span id="badgeText">Ù„Ùƒ Ø£Ù†ØªÙ</span>
        </div>
      </div>

      <div class="timer-card">
        <h3>ğŸ’Ù…Ø± Ø¹Ù„Ù‰ Ø¹Ù„Ø§Ù‚ØªÙ†Ø§</h3>
        <div id="relationshipTimer">0 ÙŠÙˆÙ… 00:00:00</div>
        <div class="timer-label" id="timerLabel">Ù…Ù†Ø° Ù¡Ù¨ ÙŠÙˆÙ†ÙŠÙˆ Ù¢Ù Ù¢Ù¥</div>
      </div>
    </div>

    <!-- 1) VIDEO FIRST -->
    <div class="glass">
      <div class="section">
        <div class="sectionTitle">
          <b id="localVideoTitle">ğŸï¸  ÙÙŠØ¯ÙŠÙˆ Ø­Ø¨  Ù…Ù† Ø¹ÙŠØªÙ‰ Ø§Ù„Ù‰ ÙÙ„Ø­ ÙƒÙ…Ù„ÙŠ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙƒØ§Ù…Ù„ ÙÙŠ Ù‡Ø¯ÙŠÙ‡</b>
          <span class="meta" id="localTime">00:00 / 00:00</span>
        </div>

        <div class="videoWrap">
          <video class="custom-video" id="localVideo" playsinline preload="metadata">
            <source src="videos/love-video.mp4" type="video/mp4">
            <source src="videos/love-video.webm" type="video/webm">
            Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ.
          </video>
        </div>

        <!-- controls OUTSIDE video (progress + volume) -->
        <div class="controlsStack">
          <div class="rangeRow">
            <div class="rangeHead">
              <span>â±ï¸ Ù…Ù† Ù‡Ù†ÙŠ ØªÙ‚Ø¯Ù…ÙŠÙ†</span>
              <span class="meta"><span id="localCurrentTime">00:00</span> / <span id="localDuration">00:00</span></span>
            </div>
            <input id="videoSeek" type="range" min="0" max="1000" value="0">
          </div>

          <div class="rangeRow">
            <div class="rangeHead">
              <span>ğŸ”Š ØµÙˆØª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</span>
              <span class="meta" id="videoVolLabel">80%</span>
            </div>
            <input id="videoVol" type="range" min="0" max="1" step="0.01" value="0.8">
          </div>

          <div class="btnRow">
            <button class="btn primary" id="playLocalBtn">â–¶ ØªØ´ØºÙŠÙ„</button>
            <button class="btn soft" id="muteLocalBtn">ğŸ”Š ØµÙˆØª</button>
            <button class="btn soft" id="rew5Btn">âª 5 Ø«ÙˆØ§Ù†ÙŠ</button>
            <button class="btn soft" id="fwd5Btn">5 Ø«ÙˆØ§Ù†ÙŠ â©</button>
            <button class="btn soft" id="fullscreenLocalBtn">â›¶ Ø´Ø§Ø´Ø© ÙƒØ§Ù…Ù„Ø©</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 2) MESSAGE UNDER VIDEO -->
    <div class="glass">
      <div class="section">
        <div class="sectionTitle">
          <b>ğŸ’Œ Ø§Ù„Ø±Ø³Ø§Ù„Ù‡</b>
          <button class="btn primary" id="messageBtn">ğŸ“¨ Ø´ÙˆÙÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ù‡</button>
        </div>

        <div class="message-box" id="messageBox">
          Ø§Ø¶ØºØ·ÙŠ Â«Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø©Â» ÙˆØ§Ø°Ø§ Ø®Ù„ØµØª Ø¨ØªØ´ØªØºÙ„ Ø§Ù„Ø§ØºÙ†ÙŠÙ‡ ÙˆØ§Ø³Ù…Ø¹ÙŠÙ‡Ø§ Ø¹Ø¯Ù„  ğŸ¬
        </div>

        <div class="reply-section">
          <h3>ğŸ’¬ Ø§Ø°Ø§ ÙˆØ¯Ø¬ ØªØ±Ø¯ÙŠÙ† Ù…Ù† Ù‡Ù†ÙŠ</h3>

          <div class="reply-input-container">
            <textarea class="reply-input" id="replyInput" placeholder="Ø§ÙƒØªØ¨ÙŠ Ø±Ø³Ø§Ù„ØªØ¬ Ù‡Ù†ÙŠ ÙˆØ§Ù†Ø³Ø®ÙŠÙ‡Ø§ ÙˆØ§Ø±Ø³Ù„ÙŠÙ‡Ø§ Ù„ÙŠ ğŸ’" maxlength="500"></textarea>
            <div class="char-counter" id="charCounter">0/500</div>
          </div>

          <div class="reply-buttons">
            <button class="btn soft" id="clearBtn">ğŸ—‘ï¸ Ù…Ø³Ø­</button>
            <button class="btn insta" id="sendDmBtn">ğŸ“© Ø¹ÙŠØ³Ù‰ Ø¨Ø§Ù†ØªØ¸Ø§Ø±Ø¬ </button>
          </div>

          <div class="dm-info">
            <strong>@wz7an</strong> Ø¯ÙˆØ³ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ù†ÙØ³Ø¬ÙŠÙ‡ Ø§Ø°Ø§ Ø¨ØªØ±Ø¯ÙŠÙ†
          </div>
        </div>
      </div>
    </div>

    <!-- 3) LAST: MEMORIES + SONG -->
    <div class="glass">
      <div class="section">
        <div class="twoCols">

          <!-- memories -->
          <div>
            <div class="sectionTitle">
              <b>ğŸ“¸ Ù†Ù‚Ø·Ù‡ Ù…Ù† Ø°ÙƒØ±ÙŠØ§ØªÙ†Ø§</b>
            </div>

            <div class="local-gallery" id="localImageGallery">
              <div class="gallery-placeholder" id="galleryPlaceholder">
                <b style="display:block; margin-bottom:6px;">Ù…Ø§ Ù„Ù‚ÙŠÙ†Ø§ ØµÙˆØ± Ù„Ù„Ø­ÙŠÙ†</b>
                <div>Ø­Ø· ØµÙˆØ±Ùƒ Ø¯Ø§Ø®Ù„ Ù…Ø¬Ù„Ø¯ <b>images</b> ÙˆØ³Ù…Ù‘Ù‡Ø§ Ù…Ø«Ù„: <b>memory1.jpg</b></div>
              </div>
            </div>
          </div>

          <!-- song -->
          <div>
            <div class="sectionTitle">
              <b>ğŸµ Ø§ØºÙ†ÙŠØªØ¬</b>
              <span class="meta" id="songTime">00:00 / 00:00</span>
            </div>

            <div class="btnRow">
              <button class="btn primary" id="songBtn">â–¶ Ù…Ù† Ù‡Ù†ÙŠ ØªØ´ØºÙ„ÙŠÙ†Ù‡Ø§ ÙŠØ±ÙˆØ­ÙŠ </button>
              <button class="btn soft" id="songMuteBtn">ğŸ”ˆ ÙƒØªÙ…</button>
            </div>

            <div class="controlsStack" style="margin-top:10px;">
              <div class="rangeRow">
                <div class="rangeHead">
                  <span>ğŸ§ Ø´Ø±ÙŠØ· Ø§Ù„Ø£ØºÙ†ÙŠØ©</span>
                  <span class="meta" id="songSeekMeta">â€”</span>
                </div>
                <input id="songSeek" type="range" min="0" max="1000" value="0">
              </div>

              <div class="rangeRow">
                <div class="rangeHead">
                  <span>ğŸ§ ØµÙˆØª Ø§Ù„Ø£ØºÙ†ÙŠØ©</span>
                  <span class="meta" id="songVolLabel">60%</span>
                </div>
                <input id="songVol" type="range" min="0" max="1" step="0.01" value="0.6">
              </div>
            </div>

            <audio id="song" preload="metadata">
              <source src="assets/song.mp3" type="audio/mpeg">
            </audio>
          </div>

        </div>
      </div>
    </div>

    <!-- 4) NEW: POEM + VOICE (same vibe like your screenshot) -->
    <div class="glass">
      <div class="section">
        <div class="poemGrid">

          <!-- poem left -->
          <div class="poemCard">
            <div class="poemTop">
              <div class="title">
                <span>ğŸ“œ</span>
                <span id="poemTitleTop">Ø§Ù„Ù‚ØµÙŠØ¯Ù‡ : Ø¨ØµÙˆØª Ø¹ÙŠØªÙ‰</span>
                <span class="miniPill" id="poemTimeTop">00:00 / 00:00</span>
              </div>

              <div style="display:flex; gap:10px; align-items:center;">
                <span class="miniPill">âœï¸ Ø§Ù‡Ø¯Ø§Ø¡</span>
                <button class="iconBtn" id="poemEditBtn" title="Ø¹Ø¯Ù„ÙŠÙ‡Ø§ Ù„Ùˆ ØªØ¨ÙŠÙ† ">âœï¸</button>
              </div>
            </div>

            <div class="poemBody">
              <div class="poemBox">
                <div class="poemHeaderLine">
                  <span class="rose">ğŸ¥º</span>
                  <span id="poemName">Ø§Ù‡Ø¯Ø§Ø¡ Ù„ÙÙ„ÙˆØ­Ù‡</span>
                  <span class="rose">ğŸ¥º</span>
                </div>

                <div id="poemText" class="poemText" contenteditable="false">
ÙŠØ§ Ù†ÙˆØ± Ø¹ÙŠÙ†ÙŠ ÙˆÙŠØ§ Ø£Ø­Ù„Ù‰ ÙØ±Ø­Ø©
Ø£Ù†Øª Ø§Ù„Ø±Ø¨ÙŠØ¹ ÙÙŠ Ù„ÙŠØ§Ù„ÙŠ Ø§Ù„Ø´ØªØ§Ø¡
Ø£Ù†Øª Ø§Ù„Ø£Ù…Ù„ Ø§Ù„Ø°ÙŠ Ø¥Ù† ØºØ§Ø¨ Ø´Ù‚Ø§Ù‡
ÙˆØ£Ù†ØªÙ Ø§Ù„Ø³Ø± ÙÙŠ Ø£Ø¹Ù…Ø§Ù‚ Ø§Ù„ÙØ¶Ø§Ø¡

Ø¹ÙŠÙˆÙ†Ùƒ Ø¨Ø­Ø± ÙˆÙ‚Ù„Ø¨Ùƒ Ø¬ÙˆÙ‡Ø±Ø©
ØªØ³Ø¨Ø­ ÙÙŠÙ‡Ø§ Ø£Ø­Ù„Ø§Ù…ÙŠ ÙˆØ§Ù„Ù‡ÙˆØ§Ø¡
ÙŠØ§ Ù…Ù† Ø³ÙƒÙ†Øª ÙØ¤Ø§Ø¯ÙŠ ÙˆØªØ±Ø¨Ù‘Ø¹Øª Ø¨Ù‡
Ø£ØµØ¨Ø­ØªÙ Ø£ØºÙ†ÙŠØ© ÙÙŠ ÙƒÙ„ Ø³Ù…Ø§Ø¡

Ø³Ø§Ø¨Ù‚Ù‰ Ø£Ø­Ø¨Ùƒ Ù…Ù‡Ù…Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø³Ø§ÙØ©
ÙˆØ£ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø¹Ù„Ù‰ Ø¬Ø¯Ø±Ø§Ù† Ø§Ù„ÙˆÙØ§Ø¡
Ù„Ø£Ù†Ùƒ Ø£Ù†Øª Ø§Ù„Ù†Ø¹ÙŠÙ… ÙˆØ§Ù„Ø­Ù‚ÙŠÙ‚Ø©
ÙˆØ£Ù†Øª Ø¨Ø¯Ø§ÙŠØ§ØªÙŠ ÙˆØ£Ù†ØªÙ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©
                </div>

                <div class="poemFooter">
                  <span>ğŸ¥º Ø±Ø³Ø§Ù„Ù‡ ÙˆØµÙˆØª Ø´ØªØ¨ÙŠÙ† Ø¨Ø¹Ø¯</span>
                  <button class="tinyBtn" id="copyPoemBtn">ğŸ“‹Ù…Ù† Ù‡Ù†ÙŠ ØªÙ†Ø³Ø®ÙŠÙ†Ù‡Ø§</button>
                </div>
              </div>
            </div>
          </div>

          <!-- voice right -->
          <div class="audioCard">
            <div class="audioTop">
              <b>ğŸ™ï¸ Ø´ØªØ¨ÙŠÙ† Ø¨Ø¹Ø¯ Ø¹ÙŠØ³Ù‰ ÙˆÙ‚Ø±Ø§Ù‡Ø§ Ù„Ø¬</b>
              <span class="meta" id="voiceTimeTop">00:00 / 00:00</span>
            </div>

            <div class="audioBody">
              <div class="audioHint">ğŸ’— Ø§Ù‡Ø¯Ø§Ø¡ Ù…Ù† Ø¹ÙŠØ³Ù‰ Ù„Ø¬ Ø§Ù†ØªÙŠ Ø¨Ø³ </div>

              <div class="audioBtnRow">
                <button class="tinyBtn primary" id="voicePlayBtn">â–¶  Ù…Ù† Ù‡Ù†ÙŠ ØªØ´ØºÙ„ÙŠÙ†Ù‡</button>
                <button class="tinyBtn" id="voiceMuteBtn">ğŸ”ˆ ÙƒØªÙ…</button>
                <button class="tinyBtn" id="voiceRestartBtn">ğŸ” Ø¹ÙŠØ¯ÙŠÙ‡Ø§ Ù…Ù† Ù‡Ù†ÙŠ</button>
              </div>

              <div class="seekWrap">
                <div class="rangeRow" style="margin:0;">
                  <div class="labelRow">
                    <span>â±ï¸ Ø´Ø±ÙŠØ· Ø§Ù„ØµÙˆØª</span>
                    <span class="meta" id="voiceSeekMeta">â€”</span>
                  </div>
                  <input id="voiceSeek" type="range" min="0" max="1000" value="0">
                </div>

                <div class="rangeRow" style="margin:0;">
                  <div class="labelRow">
                    <span>ğŸ”Š Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª</span>
                    <span class="meta" id="voiceVolLabel">70%</span>
                  </div>
                  <input id="voiceVol" type="range" min="0" max="1" step="0.01" value="0.7">
                </div>
              </div>

              <audio id="voiceAudio" preload="metadata">
                <!-- Ø­Ø· Ù…Ù„ÙÙƒ Ù‡Ù†Ø§ -->
                <source src="assets/voice.mp3" type="audio/mpeg">
              </audio>
            </div>
          </div>

        </div>
      </div>
    </div>

    <div class="glass footer">
      <div id="footerLeft">â¤ï¸ ØµÙ†Ø¹ Ø¨ÙƒÙ„ Ø§Ù„Ø­Ø¨ - Ø¹ÙŠØ³Ù‰</div>
      <div id="footerRight">Ù„Ù„Ù…Ù„ÙƒØ© ÙØ±Ø­ ÙÙ‚Ø·</div>
    </div>
  </div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox">
    <div class="lightbox-content">
      <img id="lightboxImage" src="" alt="">
      <button class="lightbox-close" id="lightboxClose">Ã—</button>
      <button class="lightbox-nav prev" id="lightboxPrev">â€º</button>
      <button class="lightbox-nav next" id="lightboxNext">â€¹</button>
    </div>
  </div>

  <!-- End Video Modal -->
  <div class="modal" id="endModal" aria-hidden="true">
    <div class="modalBox">
      <div class="modalTop">
        <b>ğŸ€ Ø®Ù„Øµ Ø§Ù„ÙÙŠØ¯ÙŠÙˆâ€¦</b>
        <button class="btn soft" id="closeEndModal">Ø³ÙƒØ±ÙŠÙ‡Ø§</button>
      </div>
      <div class="modalBody" id="endModalBody">
        <div style="white-space:pre-wrap" id="endModalText"></div>
      </div>
      <div class="modalActions">
        <a class="btn insta" id="endInstaLink" href="https://instagram.com/wz7an" target="_blank" rel="noreferrer">ğŸ’¬Ø­Ø³Ø§Ø¨ Ø¹ÙŠØªÙ‰</a>
        <button class="btn primary" id="replayBtn">ğŸ” Ø¹ÙŠØ¯ÙŠÙ‡Ø§ Ù„Ùˆ ØªØ¨ÙŠÙ† ÙŠØ±ÙˆØ­ÙŠ</button>
      </div>
    </div>
  </div>

  <!-- Alert -->
  <div class="alert" id="alert">
    <div class="icon" id="alertIcon">i</div>
    <span id="alertText"></span>
  </div>

  <script>
    // =======================
    // CONFIG (Ø¹Ø¯Ù‘Ù„ Ù‡Ù†Ø§ ÙÙ‚Ø·)
    // =======================
    const CONFIG = {
      siteTitle: "ğŸ’– Ù„Ù„Ù…Ù„ÙƒØ© ÙØ±Ø­ ğŸ’–",
      siteSubtitle: "Ø§Ù‡Ø¯Ø§Ø¡ Ù…Ù† Ø¹ÙŠØ³Ù‰ Ù„ÙØ±ÙˆØ­ØªÙ‡",
      badgeText: "Ù„Ø¬ Ø§Ù†ØªÙŠ",
      signature: "ğŸ§¸ Ù…Ù† Ø¹ÙŠØ³Ù‰ Ø§Ù„Ù‰ ÙØ±Ø­",
      footerLeft: "â¤ï¸ ØµÙ†Ø¹ Ø¨ÙƒÙ„ Ø§Ù„Ø­Ø¨ - Ø¹ÙŠØ³Ù‰",
      footerRight: "Ù„Ù„Ù…Ù„ÙƒØ© ÙØ±Ø­ ÙÙ‚Ø·",

      relationshipStart: "2025-06-18T00:00:00+03:00",
      timerLabel: "Ù…Ù† Ù¡Ù¨ ÙŠÙˆÙ†ÙŠÙˆ Ù¢Ù Ù¢Ù¥",

      files: {
        video: "videos/love-video.mp4",
        videoBackup: "videos/love-video.webm",
        imagesFolder: "images/",
        imageNames: [
          "memory1.jpg","memory1.jpeg","memory1.png",
          "memory2.jpg","memory2.jpeg","memory2.png",
          "memory3.jpg","memory3.jpeg","memory3.png",
          "memory4.jpg","memory4.jpeg","memory4.png",
          "photo1.jpg","photo1.jpeg","photo1.png",
          "photo2.jpg","photo2.jpeg","photo2.png",
          "love.jpg","love.jpeg","love.png",
          "us.jpg","us.jpeg","us.png"
        ]
      },

      messageLines: [
        "ÙŠØ§ Ù…Ù„ÙƒØ© Ù‚Ù„Ø¨ÙŠ...",
        "Ù‡Ø°Ø§ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ù† ØµÙ†Ø¹ ÙŠØ¯ÙŠ Ù„ÙƒÙ ÙÙ‚Ø·.",
        "ÙƒÙ„ Ù„Ø­Ø¸Ø© Ù…Ø¹ÙƒÙ Ù‡ÙŠ Ø£Ø¬Ù…Ù„ Ù‚ØµØ© Ø­Ø¨.",
        "Ø¹ÙŠÙ†Ø§ÙƒÙ Ù†Ø¬ÙˆÙ… ØªØ¶ÙŠØ¡ Ø¹Ø§Ù„Ù…ÙŠ Ø§Ù„Ù…Ø¸Ù„Ù….",
        "Ù‚Ù„Ø¨ÙŠ ÙŠØ±ÙØ±Ù ÙƒÙ„Ù…Ø§ Ø³Ù…Ø¹ Ø§Ø³Ù…ÙƒÙ: ÙØ±Ø­.",
        "Ø£Ù†ØªÙ Ø§Ù„ÙˆØ±Ø¯Ø© Ø§Ù„ØªÙŠ Ø¬Ø¹Ù„Øª Ø­Ø¯ÙŠÙ‚ØªÙŠ Ø¬Ù†Ø©.",
        "Ø£Ø­Ø¨Ø¨ØªÙƒÙ Ù…Ù†Ø° Ø§Ù„Ù„Ø­Ø¸Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰... ÙˆØ³Ø£Ø­Ø¨ÙƒÙ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø¨Ø¯.",
        "Ù„ÙƒÙ ÙÙŠ Ù‚Ù„Ø¨ÙŠ Ù…ÙƒØ§Ù† Ù„Ø§ ÙŠÙ…Ù„Ø¤Ù‡ Ø£Ø­Ø¯ Ø³ÙˆØ§ÙƒÙ.",
        "Ø£Ù†ØªÙ Ø§Ù„Ø­Ø¨ Ø§Ù„Ø°ÙŠ Ø·Ø§Ù„Ù…Ø§ Ø­Ù„Ù…Øª Ø¨Ù‡.",
        "Ø´ÙƒØ±Ø§Ù‹ Ù„Ø£Ù†ÙƒÙ Ø¬Ø¹Ù„ØªÙ†ÙŠ Ø£Ø´Ø¹Ø± Ø¨Ø£Ù†Ù†ÙŠ Ø§Ù„Ø£ÙƒØ«Ø± Ø­Ø¸Ø§Ù‹ ÙÙŠ Ø§Ù„ÙƒÙˆÙ†.",
        "Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø¨Ø¯... Ø­Ø¨ÙƒÙ â¤ï¸"
      ],

      typing: { speedMs: 70, linePauseMs: 1100 },

      instagram: {
        username: "wz7an",
        messagePrefix: "ğŸ’Œ Ù…Ù† Ø§Ù„Ù…Ù„ÙƒØ© ÙØ±Ø­:\n\n",
        messageSuffix: "\n\nâ¤ï¸ Ù‡Ø°Ù‡ Ø±Ø³Ø§Ù„Ø© Ù…Ù† Ù…ÙˆÙ‚Ø¹ Ø­Ø¨ Ø®Ø§Øµ"
      },

      endVideoMessage: `Ø¥Ø°Ø§ ÙˆØµÙ„Ù†Ø§ Ù„Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ù‚Ø·Ø¹â€¦ ØªØ°ÙƒÙ‘Ø±ÙŠ:
Ø£Ù†Ø§ Ù…Ø§ Ø£Ø¨ÙŠ Ù…Ù†Ùƒ Ø´ÙŠ Ø¥Ù„Ø§ ØªÙƒÙˆÙ†ÙŠÙ† Ø¨Ø®ÙŠØ±â€¦ ÙˆØ§Ù„Ø¨Ø§Ù‚ÙŠ Ø¹Ù„ÙŠ ğŸ’—

ÙƒÙ„ Ù„Ø­Ø¸Ø© Ù…Ø¹Ùƒ Ø°ÙƒØ±Ù‰ØŒ ÙˆÙƒÙ„ ÙŠÙˆÙ… Ù…Ø¹Ùƒ Ù‡Ø¯ÙŠØ©.
Ø´ÙƒØ±Ø§Ù‹ Ù„Ø£Ù†Ùƒ Ø¬Ø²Ø¡ Ù…Ù† Ø­ÙŠØ§ØªÙŠ.`,

      autoPlayVideoAfterMessage: true
    };

    // =======================
    // Helpers
    // =======================
    const $ = (id)=>document.getElementById(id);

    function formatTime(seconds){
      if (!isFinite(seconds)) return "00:00";
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${String(mins).padStart(2,'0')}:${String(secs).padStart(2,'0')}`;
    }

    function showAlert(text, type="info"){
      const alertEl = $("alert");
      const alertText = $("alertText");
      const alertIcon = $("alertIcon");

      alertEl.className = "alert";
      alertEl.classList.add(type);

      const iconMap = { success:"âœ“", info:"i", warning:"!", danger:"Ã—" };
      alertIcon.textContent = iconMap[type] || "i";
      alertText.innerHTML = String(text).split("\n").join("<br>");

      alertEl.classList.add("show");
      clearTimeout(showAlert._t);
      showAlert._t = setTimeout(()=> alertEl.classList.remove("show"), 5200);
    }

    // =======================
    // State
    // =======================
    let isTyping = false;
    let currentLineIndex = 0;
    let typingInterval;

    let localVideo;
    let isLocalPlaying = false;

    let discoveredImages = [];
    let lightboxIndex = 0;

    // =======================
    // Boot
    // =======================
    document.addEventListener("DOMContentLoaded", ()=>{
      $("mainTitle").textContent = CONFIG.siteTitle;
      $("mainSubtitle").textContent = CONFIG.siteSubtitle;
      $("badgeText").textContent = CONFIG.badgeText;
      $("signatureText").textContent = CONFIG.signature;
      $("footerLeft").textContent = CONFIG.footerLeft;
      $("footerRight").textContent = CONFIG.footerRight;
      $("timerLabel").textContent = CONFIG.timerLabel;

      $("igLink").href = `https://instagram.com/${CONFIG.instagram.username}`;
      $("endInstaLink").href = `https://instagram.com/${CONFIG.instagram.username}`;

      $("endModalText").textContent = CONFIG.endVideoMessage;

      // NEW: restore poem from localStorage
      restorePoem();

      setupEventListeners();
      setupLocalVideoPlayer();
      setupSong();
      setupPoemVoice();     // NEW
      discoverLocalImages();
      updateCharCounter();
      startRelationshipTimer();

      setTimeout(()=> showAlert("ğŸ§¸ğŸ’— Ø§Ù‡Ø¯Ø§Ø¡ Ù„ Ø±ÙˆØ­ÙŠ  ", "success"), 900);
    });

    // =======================
    // Timer
    // =======================
    function startRelationshipTimer(){
      updateRelationshipTimer();
      setInterval(updateRelationshipTimer, 1000);
    }

    function updateRelationshipTimer(){
      const startDate = new Date(CONFIG.relationshipStart);
      const now = new Date();
      const diffMs = now - startDate;

      const days = Math.floor(diffMs / (1000*60*60*24));
      const hours = Math.floor((diffMs % (1000*60*60*24)) / (1000*60*60));
      const minutes = Math.floor((diffMs % (1000*60*60)) / (1000*60));
      const seconds = Math.floor((diffMs % (1000*60)) / 1000);

      $("relationshipTimer").textContent =
        `${days} ÙŠÙˆÙ… ${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
    }

    // =======================
    // Events
    // =======================
    function setupEventListeners(){
      $("messageBtn").addEventListener("click", toggleMessage);

      const replyInput = $("replyInput");
      replyInput.addEventListener("input", updateCharCounter);
      replyInput.addEventListener("keydown", (e)=>{
        if(e.key === "Enter" && e.ctrlKey) sendDM();
      });

      $("clearBtn").addEventListener("click", ()=>{
        replyInput.value = "";
        updateCharCounter();
        showAlert("ğŸ—‘ï¸ Ø¬Ø°ÙŠ Ø§Ù†Ù…Ø³Ø­Øª Ø§Ù„Ø±Ø³Ø§Ù„Ù‡  ", "info");
      });

      $("sendDmBtn").addEventListener("click", sendDM);

      $("refreshGalleryBtn").addEventListener("click", ()=>{
        showAlert("ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØµÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©...", "info");
        discoverLocalImages();
      });

      // end modal
      $("closeEndModal").addEventListener("click", ()=> $("endModal").classList.remove("show"));
      $("replayBtn").addEventListener("click", ()=>{
        $("endModal").classList.remove("show");
        localVideo.currentTime = 0;
        localVideo.play().catch(()=>{});
      });
      $("endModal").addEventListener("click", (e)=>{
        if(e.target === $("endModal")) $("endModal").classList.remove("show");
      });

      // NEW: poem edit + copy
      $("poemEditBtn").addEventListener("click", togglePoemEdit);
      $("copyPoemBtn").addEventListener("click", copyPoem);
    }

    // =======================
    // Typing message
    // =======================
    function toggleMessage(){
      if(isTyping){
        stopTyping();
        $("messageBtn").textContent = "ğŸ“¨ Ø´ÙˆÙÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ù‡";
      }else{
        startTypingMessage();
        $("messageBtn").textContent = "â¸ ÙˆÙ‚ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ù‡";
      }
    }

    function startTypingMessage(){
      if(isTyping) return;
      isTyping = true;
      currentLineIndex = 0;
      $("messageBox").innerHTML = "";
      typeNextLine();
    }

    function typeNextLine(){
      if(currentLineIndex >= CONFIG.messageLines.length){
        isTyping = false;
        $("messageBtn").textContent = "ğŸ” Ø§Ù‚Ø±ÙŠÙ‡Ø§ Ù…Ø±Ø§ Ø«Ø§Ù†ÙŠÙ‡";

        if(CONFIG.autoPlayVideoAfterMessage && localVideo && localVideo.paused){
          const p = localVideo.play();
          if(p){
            p.then(()=>{ isLocalPlaying = true; updateLocalPlayButton(); showAlert("ğŸ¬ Ø¨ØªØ´ØªØºÙ„ Ø§Ù„Ø§ØºÙ†ÙŠÙ‡  ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§", "success"); })
             .catch(()=>{});
          }
        }
        return;
      }

      const line = CONFIG.messageLines[currentLineIndex];
      const lineEl = document.createElement("div");
      lineEl.className = "message-line";
      $("messageBox").appendChild(lineEl);

      let charIndex = 0;
      clearInterval(typingInterval);

      typingInterval = setInterval(()=>{
        if(charIndex <= line.length){
          lineEl.innerHTML = line.substring(0,charIndex) + '<span class="typing-cursor"></span>';
          charIndex++;
        }else{
          clearInterval(typingInterval);
          lineEl.textContent = line;
          currentLineIndex++;
          setTimeout(typeNextLine, CONFIG.typing.linePauseMs);
        }
      }, CONFIG.typing.speedMs);
    }

    function stopTyping(){
      clearInterval(typingInterval);
      isTyping = false;
      $("messageBox").textContent = "Ø§Ø¶Øº Â«Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø©Â» ÙˆØ§Ø°Ø§ Ø®Ù„ØµØª Ø¨ØªØ´ØªØºÙ„ Ø§Ù„Ø§ØºÙ†ÙŠÙ‡ ÙˆØ§Ø³Ù…Ø¹ÙŠÙ‡Ø§ Ø¹Ø¯Ù„  ğŸ¬";
    }

    // =======================
    // Video Player (progress outside + volume)
    // =======================
    function setupLocalVideoPlayer(){
      localVideo = $("localVideo");
      const seek = $("videoSeek");
      const vol = $("videoVol");

      localVideo.src = CONFIG.files.video;
      localVideo.volume = Number(vol.value);

      localVideo.addEventListener("loadedmetadata", ()=>{
        $("localDuration").textContent = formatTime(localVideo.duration);
        $("localTime").textContent = `${formatTime(localVideo.currentTime)} / ${formatTime(localVideo.duration)}`;
      });

      localVideo.addEventListener("timeupdate", ()=>{
        const dur = localVideo.duration || 0;
        if(dur > 0){
          seek.value = String(Math.floor((localVideo.currentTime/dur)*1000));
        }
        $("localCurrentTime").textContent = formatTime(localVideo.currentTime);
        $("localTime").textContent = `${formatTime(localVideo.currentTime)} / ${formatTime(localVideo.duration)}`;
      });

      seek.addEventListener("input", ()=>{
        const dur = localVideo.duration || 0;
        if(dur > 0){
          localVideo.currentTime = (Number(seek.value)/1000) * dur;
        }
      });

      vol.addEventListener("input", ()=>{
        localVideo.volume = Number(vol.value);
        $("videoVolLabel").textContent = `${Math.round(localVideo.volume*100)}%`;
        if(localVideo.volume === 0) localVideo.muted = true;
        else localVideo.muted = false;
        $("muteLocalBtn").textContent = localVideo.muted ? "ğŸ”‡ ÙƒØªÙ…" : "ğŸ”Š ØµÙˆØª";
      });

      $("playLocalBtn").addEventListener("click", ()=>{
        if(localVideo.paused){
          const p = localVideo.play();
          if(p){
            p.then(()=>{ isLocalPlaying = true; updateLocalPlayButton(); })
             .catch(()=> showAlert("âš ï¸ Ø§Ù„Ù…ØªØµÙØ­ Ù…Ù†Ø¹ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ. Ø§Ø¶ØºØ· Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©.", "warning"));
          }
        }else{
          localVideo.pause();
          isLocalPlaying = false;
          updateLocalPlayButton();
        }
      });

      $("muteLocalBtn").addEventListener("click", ()=>{
        localVideo.muted = !localVideo.muted;
        $("muteLocalBtn").textContent = localVideo.muted ? "ğŸ”‡ ÙƒØªÙ…" : "ğŸ”Š ØµÙˆØª";
      });

      $("rew5Btn").addEventListener("click", ()=>{
        localVideo.currentTime = Math.max(0, localVideo.currentTime - 5);
      });

      $("fwd5Btn").addEventListener("click", ()=>{
        const dur = localVideo.duration || 0;
        if(dur > 0) localVideo.currentTime = Math.min(dur, localVideo.currentTime + 5);
      });

      $("fullscreenLocalBtn").addEventListener("click", ()=>{
        if(localVideo.requestFullscreen) localVideo.requestFullscreen();
        else if(localVideo.webkitRequestFullscreen) localVideo.webkitRequestFullscreen();
      });

      localVideo.addEventListener("ended", ()=>{
        isLocalPlaying = false;
        updateLocalPlayButton();
        $("endModal").classList.add("show");
      });

      localVideo.addEventListener("error", ()=>{
        if(localVideo.src.indexOf(CONFIG.files.videoBackup) === -1){
          showAlert("âš ï¸ Ø¬Ø§Ø±ÙŠ ØªØ¬Ø±Ø¨Ø© ÙÙŠØ¯ÙŠÙˆ Ø§Ø­ØªÙŠØ§Ø·ÙŠ...", "warning");
          localVideo.src = CONFIG.files.videoBackup;
          localVideo.load();
        }else{
          showAlert("âŒ ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ. ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ù„Ù videos/", "warning");
        }
      });

      updateLocalPlayButton();
      $("videoVolLabel").textContent = `${Math.round(localVideo.volume*100)}%`;
    }

    function updateLocalPlayButton(){
      const btn = $("playLocalBtn");
      if(isLocalPlaying){
        btn.textContent = "â¸ ÙˆÙ‚ÙÙŠÙ‡ Ù…Ù† Ù‡Ù†ÙŠ";
      }else{
        if(localVideo && localVideo.currentTime > 0 && localVideo.duration && localVideo.currentTime < localVideo.duration){
          btn.textContent = "â–¶ ÙƒÙ…Ù„ÙŠÙ‡";
        }else{
          btn.textContent = "â–¶ Ø´ØºÙ„ÙŠÙ‡ Ù…Ù† Ù‡Ù†ÙŠ";
        }
      }
    }

    // =======================
    // Song (optional)
    // =======================
    function setupSong(){
      const song = $("song");
      const songBtn = $("songBtn");
      const songMuteBtn = $("songMuteBtn");
      const songSeek = $("songSeek");
      const songVol = $("songVol");
      const songTime = $("songTime");

      function updateSongTime(){
        songTime.textContent = `${formatTime(song.currentTime)} / ${formatTime(song.duration)}`;
        $("songSeekMeta").textContent = `${formatTime(song.currentTime)} / ${formatTime(song.duration)}`;
      }

      song.volume = Number(songVol.value);
      $("songVolLabel").textContent = `${Math.round(song.volume*100)}%`;

      song.addEventListener("loadedmetadata", updateSongTime);
      song.addEventListener("timeupdate", ()=>{
        const dur = song.duration || 0;
        if(dur > 0){
          songSeek.value = String(Math.floor((song.currentTime/dur)*1000));
        }
        updateSongTime();
      });

      songSeek.addEventListener("input", ()=>{
        const dur = song.duration || 0;
        if(dur > 0) song.currentTime = (Number(songSeek.value)/1000) * dur;
      });

      songVol.addEventListener("input", ()=>{
        song.volume = Number(songVol.value);
        $("songVolLabel").textContent = `${Math.round(song.volume*100)}%`;
        if(song.volume === 0) song.muted = true;
        else song.muted = false;
        songMuteBtn.textContent = song.muted ? "ğŸ”‡ ÙƒØªÙ…" : "ğŸ”ˆ ØµÙˆØª";
      });

      songMuteBtn.addEventListener("click", ()=>{
        song.muted = !song.muted;
        songMuteBtn.textContent = song.muted ? "ğŸ”‡ ÙƒØªÙ…" : "ğŸ”ˆ ØµÙˆØª";
      });

      async function toggleSong(){
        try{
          // Ù„Ùˆ Ø§Ù„ØµÙˆØª Ø´ØºØ§Ù„ ÙˆÙ‚ÙÙ‘Ù‡ (Ø¹Ù„Ø´Ø§Ù† Ù…Ø§ ÙŠØªØ¯Ø§Ø®Ù„)
          const voice = $("voiceAudio");
          if(voice && !voice.paused) voice.pause();

          if(song.paused){
            await song.play();
            songBtn.textContent = "â¸ÙˆÙ…Ù† Ù‡Ù†ÙŠ ØªÙˆÙ‚ÙÙŠÙ†Ù‡Ø§ ";
          }else{
            song.pause();
            songBtn.textContent = "â–¶ Ø´ØºÙ„ÙŠÙ‡Ø§ Ù…Ù† Ù‡Ù†ÙŠ ";
          }
        }catch(e){
          showAlert("âš ï¸ Ø¹Ù„Ù‚", "warning");
        }
      }
      songBtn.addEventListener("click", toggleSong);

      song.addEventListener("pause", ()=> songBtn.textContent = "â–¶ Ù…Ù† Ù‡Ù†ÙŠ ØªØ´ØºÙ„ÙŠÙ†Ù‡Ø§ ÙŠØ±ÙˆØ­ÙŠ ");
      song.addEventListener("play", ()=> songBtn.textContent = "â¸ ÙˆÙ…Ù† Ù‡Ù†ÙŠ ØªØ·ÙÙŠÙ†Ù‡Ø§ ");
    }

    // =======================
    // NEW: Poem voice player (like screenshot)
    // =======================
    function setupPoemVoice(){
      const voice = $("voiceAudio");
      const playBtn = $("voicePlayBtn");
      const muteBtn = $("voiceMuteBtn");
      const restartBtn = $("voiceRestartBtn");
      const seek = $("voiceSeek");
      const vol = $("voiceVol");

      function updateVoiceUI(){
        $("voiceTimeTop").textContent = `${formatTime(voice.currentTime)} / ${formatTime(voice.duration)}`;
        $("poemTimeTop").textContent = `${formatTime(voice.currentTime)} / ${formatTime(voice.duration)}`;
        $("voiceSeekMeta").textContent = `${formatTime(voice.currentTime)} / ${formatTime(voice.duration)}`;
      }

      // init
      voice.volume = Number(vol.value);
      $("voiceVolLabel").textContent = `${Math.round(voice.volume * 100)}%`;
      updateVoiceUI();

      voice.addEventListener("loadedmetadata", ()=>{
        updateVoiceUI();
      });

      voice.addEventListener("timeupdate", ()=>{
        const dur = voice.duration || 0;
        if(dur > 0){
          seek.value = String(Math.floor((voice.currentTime / dur) * 1000));
        }
        updateVoiceUI();
      });

      seek.addEventListener("input", ()=>{
        const dur = voice.duration || 0;
        if(dur > 0){
          voice.currentTime = (Number(seek.value) / 1000) * dur;
        }
      });

      vol.addEventListener("input", ()=>{
        voice.volume = Number(vol.value);
        $("voiceVolLabel").textContent = `${Math.round(voice.volume * 100)}%`;
        voice.muted = voice.volume === 0;
        muteBtn.textContent = voice.muted ? "ğŸ”‡ ÙƒØªÙ…" : "ğŸ”ˆ ÙƒØªÙ…";
      });

      muteBtn.addEventListener("click", ()=>{
        voice.muted = !voice.muted;
        muteBtn.textContent = voice.muted ? "ğŸ”‡ ÙƒØªÙ…" : "ğŸ”ˆ ÙƒØªÙ…";
      });

      restartBtn.addEventListener("click", ()=>{
        voice.currentTime = 0;
        voice.play().catch(()=>{});
      });

      playBtn.addEventListener("click", async ()=>{
        try{
          // Ù„Ùˆ Ø§Ù„Ø§ØºÙ†ÙŠØ© Ø´ØºØ§Ù„Ø© ÙˆÙ‚ÙÙ‡Ø§ Ø¹Ù„Ø´Ø§Ù† Ù…Ø§ ÙŠØªØ¯Ø§Ø®Ù„
          const song = $("song");
          if(song && !song.paused) song.pause();

          if(voice.paused){
            await voice.play();
            playBtn.textContent = "â¸  Ø·ÙÙŠÙ‡ Ù…Ù† Ù‡Ù†ÙŠ";
          }else{
            voice.pause();
            playBtn.textContent = "â–¶ Ø´ØºÙ„ÙŠÙ‡ Ù…Ù† Ù‡Ù†ÙŠ ";
          }
        }catch(e){
          showAlert("âš ï¸ Ø¹Ù„Ù‚", "warning");
        }
      });

      voice.addEventListener("play", ()=> playBtn.textContent = "â¸  Ø´ØºÙ„ÙŠÙ‡ Ù…Ù† Ù‡Ù†ÙŠ ");
      voice.addEventListener("pause", ()=> playBtn.textContent = "â–¶ Ø´ØºÙ„ÙŠÙ‡ Ù…Ù† Ù‡Ù†ÙŠ  ");
      voice.addEventListener("ended", ()=> playBtn.textContent = "â–¶ Ø´ØºÙ„ÙŠÙ‡ Ù…Ù† Ù‡Ù†ÙŠ  ");
    }

    // =======================
    // NEW: Poem edit/copy + persist
    // =======================
    function togglePoemEdit(){
      const box = $("poemText");
      const btn = $("poemEditBtn");

      const isEditing = box.getAttribute("contenteditable") === "true";
      if(isEditing){
        box.setAttribute("contenteditable","false");
        btn.textContent = "âœï¸";
        savePoem();
        showAlert("âœ… ØªÙ…Øª Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ", "success");
      }else{
        box.setAttribute("contenteditable","true");
        btn.textContent = "âœ…";
        box.focus();
        showAlert("âœï¸ Ø§Ù„Ø­ÙŠÙ† ØªÙ‚Ø¯Ø±ÙŠÙ† ØªØ¹Ø¯Ù„ÙŠÙ†Ù‡Ø§ ÙŠØ±ÙˆØ­ÙŠ", "info");
      }
    }

    function copyPoem(){
      const text = $("poemText").innerText.trim();
      navigator.clipboard.writeText(text).then(()=>{
        showAlert("ğŸ“‹Ù†Ø³Ø®ØªÙŠÙ‡Ø§", "success");
      }).catch(()=>{
        showAlert("âš ï¸ Ù…Ø§ Ù‚Ø¯Ø±Øª Ø£Ù†Ø³Ø® ", "warning");
      });
    }

    function savePoem(){
      try{
        localStorage.setItem("poem_text_saved", $("poemText").innerText);
      }catch(e){}
    }

    function restorePoem(){
      try{
        const saved = localStorage.getItem("poem_text_saved");
        if(saved && saved.trim().length){
          $("poemText").innerText = saved;
        }
      }catch(e){}
    }

    // =======================
    // Gallery discovery (local images/)
    // =======================
    function discoverLocalImages(){
      const gallery = $("localImageGallery");
      const placeholder = $("galleryPlaceholder");
      discoveredImages = [];
      placeholder.style.display = "none";

      let loadedCount = 0;
      const maxAttempts = CONFIG.files.imageNames.length;

      if(maxAttempts === 0){
        placeholder.style.display = "block";
        return;
      }

      CONFIG.files.imageNames.forEach((imageName)=>{
        const img = new Image();
        const imagePath = CONFIG.files.imagesFolder + imageName;

        img.onload = ()=>{
          discoveredImages.push({
            src: imagePath,
            title: `Ø°ÙƒØ±Ù‰ ${discoveredImages.length + 1}`,
            alt: `ØµÙˆØ±Ø© Ø°ÙƒØ±ÙŠØ§Øª ${discoveredImages.length + 1}`
          });
          loadedCount++;
          if(loadedCount === maxAttempts) finalizeGallery();
        };

        img.onerror = ()=>{
          loadedCount++;
          if(loadedCount === maxAttempts) finalizeGallery();
        };

        img.src = imagePath;
      });

      function finalizeGallery(){
        if(discoveredImages.length === 0){
          placeholder.style.display = "block";
          placeholder.innerHTML = `
            <b style="display:block; margin-bottom:6px;">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØµÙˆØ±</b>
            <div>Ø£Ø¶Ù ØµÙˆØ±Ùƒ ÙÙŠ <b>images/</b> ÙˆØ³Ù…Ù‘Ù‡Ø§ Ù…Ø«Ù„: <b>memory1.jpg</b></div>
          `;
          gallery.innerHTML = "";
          gallery.appendChild(placeholder);
        }else{
          updateLocalGallery();
          showAlert(`ğŸ“¸ ØªÙ… Ø§ÙƒØªØ´Ø§Ù ${discoveredImages.length} ØµÙˆØ±Ø©`, "success");
        }
      }
    }

    function updateLocalGallery(){
      const gallery = $("localImageGallery");
      gallery.innerHTML = "";

      discoveredImages.forEach((image, index)=>{
        const item = document.createElement("div");
        item.className = "local-gallery-item";
        item.innerHTML = `
          <img src="${image.src}" alt="${image.alt}" loading="lazy">
          <div class="local-gallery-overlay">${image.title}</div>
        `;
        item.addEventListener("click", ()=> openLightbox(index));
        gallery.appendChild(item);
      });
    }

    // =======================
    // Lightbox
    // =======================
    function openLightbox(index){
      if(!discoveredImages.length) return;
      lightboxIndex = index;
      $("lightbox").classList.add("active");
      updateLightbox();

      $("lightboxClose").onclick = ()=> $("lightbox").classList.remove("active");
      $("lightboxPrev").onclick = ()=> { lightboxIndex = (lightboxIndex - 1 + discoveredImages.length) % discoveredImages.length; updateLightbox(); };
      $("lightboxNext").onclick = ()=> { lightboxIndex = (lightboxIndex + 1) % discoveredImages.length; updateLightbox(); };

      $("lightbox").onclick = (e)=>{ if(e.target === $("lightbox")) $("lightbox").classList.remove("active"); };

      const keyHandler = (e)=>{
        if(!$("lightbox").classList.contains("active")) return;
        if(e.key === "Escape"){ $("lightbox").classList.remove("active"); document.removeEventListener("keydown", keyHandler); }
        if(e.key === "ArrowRight"){ lightboxIndex = (lightboxIndex - 1 + discoveredImages.length) % discoveredImages.length; updateLightbox(); }
        if(e.key === "ArrowLeft"){ lightboxIndex = (lightboxIndex + 1) % discoveredImages.length; updateLightbox(); }
      };
      document.addEventListener("keydown", keyHandler);
    }

    function updateLightbox(){
      const img = discoveredImages[lightboxIndex];
      $("lightboxImage").src = img.src;
      $("lightboxImage").alt = img.alt;
    }

    // =======================
    // Reply / DM
    // =======================
    function updateCharCounter(){
      const v = $("replyInput").value.length;
      const max = $("replyInput").maxLength;
      $("charCounter").textContent = `${v}/${max}`;
      $("charCounter").style.color = (v > max * 0.8) ? "#FF5BA6" : "var(--muted)";
    }

    function sendDM(){
      const message = $("replyInput").value.trim();
      if(!message){
        showAlert("âš ï¸ Ø§Ø±Ø³Ù„ÙŠ Ø§ÙŠ Ø´ÙŠØ¡ ÙŠØ±ÙˆØ­ Ø¹ÙŠØ³Ù‰  ", "warning");
        $("replyInput").focus();
        return;
      }
      if(message.length < 3){
        showAlert("âš ï¸ÙŠØ±ÙˆØ­ÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ù‡ Ù‚ØµÙŠØ±Ù‡ ", "warning");
        return;
      }

      const url = `https://www.instagram.com/${CONFIG.instagram.username}/`;
      const win = window.open(url, "_blank");

      if(win){
        showAlert(
          `âœ… Ø§Ù†ÙØªØ­ Ø­Ø³Ø§Ø¨ÙŠ  @${CONFIG.instagram.username}\n\nğŸ“ Ø§Ù†Ø³Ø®ÙŠ  Ø§Ù„Ø±Ø³Ø§Ù„Ù‡ ÙˆØ§Ø±Ø³Ù„ÙŠÙ‡Ø§ Ø¨Ø§Ù„Ù€ DM:\n"${message.substring(0,60)}${message.length>60?'...':''}"`,
          "success"
        );

        try{
          localStorage.setItem("farah_last_dm", message);
          localStorage.setItem("farah_dm_time", new Date().toISOString());
        }catch(e){}

        setTimeout(()=> showAlert("ğŸ’¡ :   Ø§Ø±Ø³Ù„ÙŠÙ‡Ø§ Ø®Ø§Øµ     ", "info"), 3500);
      }else{
        showAlert("âš ï¸ ", "warning");
      }
    }
  </script>
</body>
</html>


